{
  "_schema": "SYSTEM_STATE_COMPACT_V1",
  "_description": "Compact JSON representation of AI-OS current state - single source for external agents",
  "_version": "1.1",
  "_generated": "2025-11-26T18:55:00Z",
  "_generated_by": "Claude Desktop (BLOCK_SYSTEM_STATE_COMPACT_REFRESH_V2)",
  "system": {
    "name": "AI-OS",
    "description": "Personal AI operating system with integrated GitHub and Google Workspace services",
    "repo": "edri2or-commits/ai-os",
    "branch": "main",
    "phase": "Phase 2.3 – Stabilizing the Hands (Sync & State Alignment)",
    "mode": "INFRA_ONLY",
    "automations_enabled": false,
    "sandbox_only": true
  },
  "architecture_model": {
    "type": "unified",
    "description": "AI-OS is a single integrated system with multiple interfaces. No rigid role hierarchy.",
    "components": [
      "All AI interfaces (Claude, GPT, Chat1) can plan and execute based on their technical capabilities",
      "Or is the system owner and approver, not restricted from technical work",
      "Services and tools are shared resources available to all interfaces"
    ]
  },
  "interfaces": [
    {
      "id": "claude_desktop",
      "name": "Claude Desktop",
      "type": "ai_interface",
      "status": "up",
      "description": "Local AI interface with full MCP access",
      "capabilities": [
        "Full MCP access: GitHub, Filesystem, Windows, Google (read-only), Canva, Browser",
        "Direct local repo access",
        "Git operations: clone, commit, push (with approval)",
        "Windows system control: PowerShell, UI automation",
        "Document creation: Word, PowerPoint, Excel, PDF",
        "State Layer management",
        "GitHub MCP Client access (port 8081) for remote operations"
      ],
      "limitations": [
        "No push to remote without Or's explicit approval",
        "No autonomous service deployment",
        "No CONSTITUTION.md changes without Or's approval",
        "Google write access: read-only via MCP (write access via GPT only)",
        "No live automations on Or's life during INFRA_ONLY mode"
      ],
      "use_cases": [
        "Local file operations",
        "Code execution and PowerShell",
        "Repo updates (local and remote API)",
        "Windows automation",
        "State Layer maintenance"
      ],
      "notes": "Part of AI-OS unified system. Primary 'Hands' for local operations."
    },
    {
      "id": "gpt_chatgpt",
      "name": "GPT (ChatGPT)",
      "type": "ai_interface",
      "status": "up",
      "description": "AI interface with Custom Actions for Google Workspace and GitHub",
      "capabilities": [
        "Google Workspace full R/W via Custom Actions: Gmail, Calendar, Drive, Docs, Sheets, Tasks",
        "GitHub access via Custom Actions: read/write files, branches, commits, PRs",
        "High-level planning, research, and architecture design",
        "Spec writing and documentation",
        "Drive Snapshot access (when available)",
        "Deep Research (external reports analysis)"
      ],
      "limitations": [
        "No MCP access (currently)",
        "No direct local repo access",
        "Depends on ngrok tunnel for local services",
        "GitHub Actions in DRY RUN mode (decision DEC-003)"
      ],
      "use_cases": [
        "Google Workspace operations (write)",
        "Strategic planning and architecture",
        "Deep Research and analysis",
        "Documentation and specs",
        "Access from anywhere (not limited to local machine)"
      ],
      "notes": "Part of AI-OS unified system. Primary 'Research & Design' interface."
    },
    {
      "id": "chat1_telegram",
      "name": "Chat1 Telegram Bot",
      "type": "ai_interface",
      "status": "partial",
      "description": "Natural language interface via Telegram (Hebrew)",
      "capabilities": [
        "Natural language input (Hebrew)",
        "Plan presentation with approval buttons (✅/❌)",
        "Route to Agent Gateway",
        "Human-in-the-loop enforcement"
      ],
      "limitations": [
        "Not deployed persistently - requires manual startup",
        "Limited to Telegram interface",
        "Depends on TELEGRAM_BOT_TOKEN and OPENAI_API_KEY",
        "UI only - does not execute without approval"
      ],
      "use_cases": [
        "Mobile communication",
        "Simple Hebrew interface",
        "Quick plan approval"
      ],
      "notes": "Code ready at chat/telegram_bot.py but not running as service"
    }
  ],
  "owner": {
    "name": "Or",
    "role": "System owner and approver",
    "authority": [
      "Source of intent and priorities",
      "Approves significant/risky operations",
      "Can work directly with tools if desired"
    ],
    "notes": "Not restricted to 'zero technical actions' - flexible approach"
  },
  "services": [
    {
      "id": "github",
      "name": "GitHub",
      "type": "code_hosting",
      "status": "up",
      "access": "MCP GitHub Client (port 8081) + Claude MCP + GPT Actions",
      "notes": "Full R/W access, GPT Actions working"
    },
    {
      "id": "google-gmail",
      "name": "Gmail",
      "type": "email",
      "status": "up",
      "access": "Google Workspace Client (port 8082)",
      "notes": "OAuth 2.0, send/list working. Claude: read-only MCP. GPT: full R/W."
    },
    {
      "id": "google-calendar",
      "name": "Google Calendar",
      "type": "calendar",
      "status": "up",
      "access": "Google Workspace Client (port 8082)",
      "notes": "OAuth 2.0, create/list events working. Claude: read-only MCP. GPT: full R/W."
    },
    {
      "id": "google-drive",
      "name": "Google Drive",
      "type": "storage",
      "status": "up",
      "access": "Google Workspace Client (port 8082) + Claude MCP",
      "notes": "Search working, used for Drive Snapshot. Claude: read-only MCP. GPT: full R/W."
    },
    {
      "id": "google-docs",
      "name": "Google Docs",
      "type": "documents",
      "status": "up",
      "access": "Google Workspace Client (port 8082)",
      "notes": "Doc creation working, used for SYSTEM_SNAPSHOT_DRIVE. GPT: full R/W."
    },
    {
      "id": "google-sheets",
      "name": "Google Sheets",
      "type": "spreadsheets",
      "status": "partial",
      "access": "Google Workspace Client (port 8082)",
      "notes": "Connected but not heavily used yet. Reserved for Control Plane UI (Phase 2.4+)."
    },
    {
      "id": "google-tasks",
      "name": "Google Tasks",
      "type": "tasks",
      "status": "partial",
      "access": "Google Workspace Client (port 8082)",
      "notes": "Connected but not heavily used yet. Reserved for task orchestration (Phase 2.4+)."
    },
    {
      "id": "ngrok",
      "name": "ngrok Tunnel",
      "type": "networking",
      "status": "up",
      "access": "CLI + start-all-services.bat",
      "notes": "WARNING: URL changes on restart, must update GPT Actions. DEC-004 approved: Cloudflare Tunnel to replace ngrok (Phase 2.4+).",
      "critical_issue": true
    },
    {
      "id": "n8n",
      "name": "n8n Automation",
      "type": "automation",
      "status": "up",
      "access": "Docker (infra/n8n/docker-compose.yml)",
      "role": "automation_kernel_infra_only_phase_2_3",
      "notes": "Running locally in Docker. Port 5678. INFRA_ONLY - no live workflows yet. Selected as official Automation Kernel per DEC-006 (approved 2025-11-27). Will serve as primary workflow platform in Phase 2.4+."
    },
    {
      "id": "mcp_github_client",
      "name": "MCP GitHub Client",
      "type": "integration",
      "status": "up",
      "access": "FastAPI service (port 8081)",
      "scope": "infra",
      "notes": "GitHub PR Automator / MCP GitHub Client. Provides programmatic access to GitHub API for PR creation, file operations. Used by scripts/open_pr_for_branch.py. Smoke test passed 2025-11-27."
    },
    {
      "id": "make",
      "name": "Make.com",
      "type": "automation",
      "status": "not_configured",
      "access": "External SaaS",
      "notes": "Not part of AI-OS core per DEC-006 (approved 2025-11-27). n8n selected as official Automation Kernel. Make.com may be used for personal experiments but not as system component."
    },
    {
      "id": "docker",
      "name": "Docker",
      "type": "containerization",
      "status": "planned",
      "access": "Local Docker Desktop",
      "notes": "Prepared but not in active use. Will be used for n8n deployment (Phase 2.4+)."
    },
    {
      "id": "cloudflare-tunnel",
      "name": "Cloudflare Tunnel",
      "type": "networking",
      "status": "planned",
      "access": "Not configured",
      "notes": "Selected as official connectivity solution per DEC-004 (approved 2025-11-26). Will replace ngrok in Phase 2.4+."
    }
  ],
  "services_summary": {
    "up": 10,
    "partial": 3,
    "planned": 2,
    "not_configured": 1,
    "broken": 0,
    "total": 16
  },
  "safety_constraints": {
    "description": "Apply to all interfaces regardless of who uses them",
    "rules": [
      "No push to remote without Or's explicit approval",
      "No live automations on Or's life during INFRA_ONLY (Phase 2.3)",
      "All writes must be logged in EVENT_TIMELINE with clear commit messages",
      "No CONSTITUTION changes without Or's explicit approval",
      "Complete transparency - every change visible, explainable, logged"
    ]
  },
  "open_gaps": [
    {
      "id": "GAP-001",
      "priority": "critical",
      "title": "ngrok URL instability",
      "description": "URL changes on every restart, breaking GPT Actions",
      "possible_solution": "Cloudflare Tunnel with stable domain (DEC-004 pending)",
      "status": "decision_in_progress"
    },
    {
      "id": "GAP-002",
      "priority": "high",
      "title": "No persistent deployment",
      "description": "All services require local machine running - not available 24/7",
      "possible_solution": "Cloud deployment (Google Cloud Run) or VPS"
    },
    {
      "id": "GAP-003",
      "priority": "high",
      "title": "Chat1 not deployed persistently",
      "description": "Code ready but not running as service",
      "possible_solution": "Deploy as service (Docker or Cloud)"
    },
    {
      "id": "GAP-004",
      "priority": "high",
      "title": "n8n vs Make.com decision",
      "description": "Need to decide which automation platform to use as kernel",
      "possible_solution": "n8n Self-Hosted as automation kernel",
      "status": "closed_resolved",
      "decision_ref": "DEC-006",
      "resolved_date": "2025-11-27",
      "resolution": "n8n selected as official Automation Kernel per DEC-006. Make.com not part of core OS."
    },
    {
      "id": "GAP-005",
      "priority": "medium",
      "title": "PowerShell reliability issues",
      "description": "PowerShell commands fail silently (Status Code: 1, no error) during infrastructure operations",
      "possible_solution": "Investigate root cause, standardize on Filesystem tools, or fix PowerShell configuration",
      "status": "block_created",
      "related_block": "BLOCK_POWERSHELL_STABILITY_AND_HEALTHCHECK_V1",
      "related_incidents": [
        "EVT-2025-11-26-INCIDENT-001"
      ],
      "notes": "First infrastructure incident logged under NO-KOMBINOT policy"
    },
    {
      "id": "GAP-006",
      "priority": "medium",
      "title": "Drive Snapshot sync is manual",
      "description": "No auto-refresh mechanism for GPT to get latest state",
      "possible_solution": "Automation for sync (when moving from INFRA_ONLY)"
    },
    {
      "id": "GAP-006",
      "priority": "medium",
      "title": "AUTOMATIONS_REGISTRY maintenance",
      "description": "Need to keep registry updated as system evolves",
      "possible_solution": "Ongoing maintenance task"
    },
    {
      "id": "GAP-007",
      "priority": "low",
      "title": "Google Sheets/Tasks underutilized",
      "description": "Connected but not integrated into workflows",
      "possible_solution": "Design Control Plane UI using Sheets (Phase 2.4+)"
    },
    {
      "id": "GAP-008",
      "priority": "low",
      "title": "Cloud deployment timing",
      "description": "Decision pending on when to move to always-on operation",
      "possible_solution": "Define criteria for production readiness"
    }
  ],
  "pending_decisions": [
    {
      "id": "DEC-004",
      "title": "ngrok vs Cloudflare Tunnel",
      "description": "Choose connectivity solution for stable GPT Actions access",
      "status": "in_progress",
      "owner": "Or + GPT",
      "priority": "high",
      "notes": "Deep Research completed, decision draft pending"
    },
    {
      "id": "DEC-006",
      "title": "n8n vs Make.com",
      "description": "Choose automation kernel for AI-OS nervous system",
      "status": "in_progress",
      "owner": "Or + GPT",
      "priority": "high",
      "notes": "Deep Research completed, decision draft pending. Direction: n8n Self-Hosted as primary kernel."
    }
  ],
  "recent_decisions": [
    {
      "id": "DEC-005",
      "title": "AUTO-GAS-001 Legacy Apps Script",
      "decision": "Path C: Disable",
      "date": "2025-11-26",
      "description": "Disabled legacy Collector_Gmail_to_Records Apps Script that was failing hourly with auth errors"
    }
  ],
  "state_layer_files": {
    "description": "Files that provide synchronized state across all interfaces",
    "quick_sync": [
      {
        "path": "docs/SESSION_NOTE.md",
        "purpose": "Current session intent and constraints"
      },
      {
        "path": "docs/INFRA_MAP.md",
        "purpose": "Infrastructure and integrations map"
      },
      {
        "path": "docs/AGENT_SYNC_OVERVIEW.md",
        "purpose": "Fast state summary",
        "version": "0.6"
      },
      {
        "path": "docs/TOOL_INTEGRATION_MAP.md",
        "purpose": "Access patterns for GitHub and Google Workspace"
      },
      {
        "path": "docs/SYNC_AGENT_SESSION_TEMPLATE_V1.md",
        "purpose": "OODA loop playbook for Sync Agent sessions"
      }
    ],
    "detailed": [
      {
        "path": "docs/system_state/agents/AGENT_CAPABILITY_PROFILE.md",
        "purpose": "Interface capabilities and limitations"
      },
      {
        "path": "docs/system_state/registries/SERVICES_STATUS.json",
        "purpose": "Service status registry"
      },
      {
        "path": "docs/system_state/timeline/EVENT_TIMELINE.jsonl",
        "purpose": "Chronological event log"
      },
      {
        "path": "docs/system_state/AUTOMATIONS_REGISTRY.jsonl",
        "purpose": "Automation inventory"
      }
    ],
    "core": [
      {
        "path": "docs/SYSTEM_SNAPSHOT.md",
        "purpose": "Detailed system state"
      },
      {
        "path": "docs/CONSTITUTION.md",
        "purpose": "9 founding principles + constitutional amendment"
      },
      {
        "path": "docs/CONTROL_PLANE_SPEC.md",
        "purpose": "Phase/Mode/Variables definition"
      },
      {
        "path": "docs/SESSION_INIT_CHECKLIST.md",
        "purpose": "Standard interface initialization protocol"
      }
    ]
  },
  "recent_work": [
    {
      "slice_id": "SLICE_GITHUB_PR_AUTOMATOR_V1",
      "date": "2025-11-27",
      "description": "GitHub PR automation infrastructure - MCP GitHub Client as official PR gateway",
      "files_created": [
        "docs/slices/SLICE_GITHUB_PR_AUTOMATOR_V1.md",
        "services/mcp_github_client/.env.template",
        "services/mcp_github_client/run_service.bat",
        "services/mcp_github_client/smoke_test_open_pr.py",
        "scripts/open_pr_for_branch.py"
      ],
      "files_modified": [
        "services/mcp_github_client/README.md",
        "services/mcp_github_client/config.py"
      ],
      "pr_number": 20,
      "pr_url": "https://github.com/edri2or-commits/ai-os/pull/20",
      "status": "pr_opened",
      "notes": "From this slice forward, PRs for slices should open automatically using this infrastructure. Self-hosted: this tool opened its own PR."
    },
    {
      "slice_id": "SLICE_GOVERNANCE_TRUTH_BOOTSTRAP_V1",
      "date": "2025-11-27",
      "description": "Governance snapshot system + fitness metrics",
      "pr_number": 21,
      "pr_url": "https://github.com/edri2or-commits/ai-os/pull/21",
      "status": "pr_opened",
      "notes": "PR opened using new automated PR tool (scripts/open_pr_for_branch.py)"
    },
    {
      "block_id": "STATE_LAYER_COMPLETION_V1",
      "date": "2025-11-26",
      "description": "Created 6 missing State Layer files",
      "event_id": "EVT-001"
    },
    {
      "block_id": "ROLE_MODEL_SIMPLIFICATION_V1",
      "date": "2025-11-26",
      "description": "Simplified agent role model - removed rigid hierarchy",
      "event_id": "EVT-002"
    },
    {
      "block_id": "SYSTEM_STATE_JSON_REFRESH_V2",
      "date": "2025-11-26",
      "description": "Created SYSTEM_STATE_COMPACT.json for external agents",
      "event_id": "EVT-003"
    },
    {
      "block_id": "PHASE2_23_TOOL_INTEGRATION_MAP_V1",
      "date": "2025-11-26",
      "description": "Documented access patterns for GitHub and Google Workspace",
      "event_id": "EVT-007",
      "status": "pushed"
    },
    {
      "block_id": "PHASE2_24_SYNC_AGENT_SESSION_TEMPLATE_V1",
      "date": "2025-11-26",
      "description": "Created OODA loop playbook for Sync Agent sessions",
      "event_id": "EVT-008",
      "status": "pushed"
    },
    {
      "block_id": "BLOCK_AUTO_GAS_001_DECISION",
      "date": "2025-11-26",
      "description": "Disabled legacy Apps Script Collector_Gmail_to_Records",
      "event_id": "EVT-009",
      "status": "committed_not_pushed"
    },
    {
      "block_id": "BLOCK_PHASE_LABELING_CLARIFICATION",
      "date": "2025-11-26",
      "description": "Formally declared Phase 2.3 and updated CONTROL_PLANE_SPEC",
      "status": "committed_not_pushed"
    },
    {
      "block_id": "BLOCK_AGENT_SYNC_OVERVIEW_REFRESH_V2",
      "date": "2025-11-26",
      "description": "Updated AGENT_SYNC_OVERVIEW.md with recent blocks (v0.5 → v0.6)",
      "status": "in_progress"
    },
    {
      "block_id": "BLOCK_SYSTEM_STATE_COMPACT_REFRESH_V2",
      "date": "2025-11-26",
      "description": "Refreshed SYSTEM_STATE_COMPACT.json (7+ hours outdated)",
      "status": "in_progress"
    }
  ],
  "git_status": {
    "branch": "main",
    "unpushed_commits": 1,
    "commit_hash": "3895719",
    "commit_message": "BLOCK_AUTO_GAS_001_DECISION + BLOCK_PHASE_LABELING_CLARIFICATION",
    "notes": "Push pending Or's approval"
  },
  "usage_guide": {
    "purpose": "This file serves as a single, compact source of truth for external agents or research tools",
    "when_to_use": [
      "When an external agent needs to understand AI-OS without reading multiple markdown files",
      "For Deep Research or analysis tools that need structured JSON input",
      "As a quick reference for system capabilities and constraints",
      "For generating reports or documentation about the system"
    ],
    "refresh_policy": "Update after significant system changes (Phase changes, new services, architecture updates, or after 6+ hours of inactivity)",
    "relationship_to_other_files": "This is a derivative view - SYSTEM_SNAPSHOT.md and State Layer files remain the authoritative source"
  },
  "last_daily_context_sync_utc": "2025-11-27T16:14:00.083401Z"
}