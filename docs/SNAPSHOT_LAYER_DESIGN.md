# SNAPSHOT_LAYER_DESIGN.md â€” System Snapshot Layer Design

**Version:** 0.1 (Draft)  
**Created:** 2025-11-25  
**Author:** Claude Desktop (Block 2)  
**Status:** ğŸ“ Design Phase â€” Awaiting Review  
**Purpose:** Define how to add a Drive-based System Snapshot layer on top of existing repo documentation.

---

## Design Philosophy

> **"Build gently on what exists, don't replace it."**

This design follows Or's direction:
- Use existing docs (`SYSTEM_SNAPSHOT.md`, `CONTROL_PLANE_SPEC.md`, etc.) as foundation
- Add small, targeted pieces (Registry, TODO-by-actor)
- Create a Drive layer that is a **view** of repo state, not a competing system
- Keep changes minimal and non-destructive

---

## 1. Current State Sources

### 1.1 Primary Sources in Repo

| File | Role | Freshness | Use in Snapshot Layer |
|------|------|-----------|----------------------|
| `docs/SYSTEM_SNAPSHOT.md` | Current system state, architecture, services | âœ… Fresh | **PRIMARY** â€” Base for Drive snapshot |
| `docs/CONTROL_PLANE_SPEC.md` | Mode, phase, core variables | âœ… Fresh | **VARIABLES** â€” Source for metadata |
| `docs/DECISIONS_AI_OS.md` | Locked decisions | âœ… Fresh | **CONTEXT** â€” Referenced, not duplicated |
| `agents/AGENTS_INVENTORY.md` | Agent roles and status | âœ… Fresh | **AGENTS** â€” Source for agents section |
| `docs/PHASE2_CHECKLIST.md` | Phase progress | âœ… Fresh | **PROGRESS** â€” Source for active phase |
| `docs/EVENT_TIMELINE_SPEC.md` | Event logging spec | âœ… Fresh | **SPEC** â€” Structure for events section |

### 1.2 Sources in Drive

| Document | Role | Status |
|----------|------|--------|
| "AI-OS ×©×“×¨×•×’ ×›×œ×™× ×œ××•×˜×•××¦×™×”" | Research/Vision doc | ğŸ—„ï¸ Historical â€” Not current direction |
| Test documents | GPT integration tests | âŒ Not relevant |

### 1.3 What's Missing Today

| Gap | Impact |
|-----|--------|
| No `AUTOMATIONS_REGISTRY` | Can't track automations systematically |
| No `EVENT_TIMELINE` data | Events spec exists, no actual log |
| No Drive-synced snapshot | GPT Planning Model can't see repo state directly |
| No TODO-by-actor | Tasks aren't organized by responsible agent |

---

## 2. Target Files

### 2.1 SYSTEM_SNAPSHOT_DRIVE.md (Google Drive)

**Purpose:** A readable, consolidated view of AI-OS state that the GPT Planning Model can access directly.

**Location:** Google Drive (root or dedicated folder)

**Role:** 
- **Derivative view** of repo state (not SSOT)
- **Entry point** for GPT Planning Model to understand the system
- **Communication layer** between repo reality and planning discussions

**Proposed Sections:**

```markdown
# AI-OS System Snapshot â€” Drive View

## Metadata
- Snapshot ID: SNAP-2025-11-25-001
- Generated: 2025-11-25T14:30:00Z
- Generated By: Claude Desktop
- Repo Commit: abc123...
- Phase: 2 (Stabilizing the Hands)
- Mode: INFRA_ONLY
- Confidence: High (repo synced within 24h)

## System Overview
[Brief description â€” 3-5 lines from SYSTEM_SNAPSHOT.md]

## Architecture
[Simplified diagram or link to repo diagram]

## Active Services
| Service | Port | Status | Last Verified |
[From SYSTEM_SNAPSHOT.md services table]

## Agents & Roles
| Agent | Role | Status | Capabilities |
[From AGENTS_INVENTORY.md]

## Active Phase & Plans
- Current Phase: 2 â€” Stabilizing the Hands
- Checklist: [link to PHASE2_CHECKLIST.md or summary]
- Active Plans: [any active_plans/ items]

## Automations Summary
- Total Registered: X
- Active: Y
- Source: AUTOMATIONS_REGISTRY.jsonl
[Brief table of key automations]

## TODO by Actor
| Actor | Task | Priority | Status |
[Organized by: Or / Claude / GPT GitHub / GPT Planning]

## Risks & Open Items
[From SECURITY_SECRETS_POLICY.md + known tech debt]

## Recent Events
[Last 5-10 events from EVENT_TIMELINE.jsonl]

## Links to Repo Docs
- [SYSTEM_SNAPSHOT.md](repo-link)
- [CONTROL_PLANE_SPEC.md](repo-link)
- [DECISIONS_AI_OS.md](repo-link)
```

**Update Frequency:** After significant changes, end of session, or phase transitions.

---

### 2.2 AUTOMATIONS_REGISTRY.jsonl (Repo)

**Purpose:** Single source of truth for all automations in the system.

**Location:** `docs/AUTOMATIONS_REGISTRY.jsonl`

**Role:**
- Prevents "orphan automations" (automations with no documentation)
- Provides structured data for snapshot generation
- Enables tracking of automation health

**Schema (per line):**

```json
{
  "id": "AUTO-001",
  "name": "GPT GitHub Manager",
  "type": "custom_gpt",
  "platform": "ChatGPT",
  "status": "active",
  "owner": "Or",
  "created": "2025-11-24",
  "last_verified": "2025-11-25",
  "endpoints": ["localhost:8081", "localhost:8082"],
  "triggers": ["manual"],
  "dependencies": ["ngrok", "MCP GitHub Client", "Google Workspace Client"],
  "docs": ["services/mcp_github_client/README.md"],
  "notes": "URL changes on ngrok restart"
}
```

**Example Records:**

```jsonl
{"id":"AUTO-001","name":"GPT GitHub Manager","type":"custom_gpt","platform":"ChatGPT","status":"active","owner":"Or","triggers":["manual"],"dependencies":["ngrok","MCP GitHub Client","Google Workspace Client"]}
{"id":"AUTO-002","name":"MCP GitHub Client","type":"local_service","platform":"FastAPI","status":"active","owner":"Claude/Or","triggers":["on_demand"],"port":8081}
{"id":"AUTO-003","name":"Google Workspace Client","type":"local_service","platform":"FastAPI","status":"active","owner":"Claude/Or","triggers":["on_demand"],"port":8082}
{"id":"AUTO-004","name":"Chat1 Telegram Bot","type":"telegram_bot","platform":"Telegram","status":"implemented_not_deployed","owner":"Or","triggers":["message"],"dependencies":["Agent Gateway","GPT Planner"]}
{"id":"AUTO-005","name":"ngrok Tunnel","type":"tunnel","platform":"ngrok","status":"active","owner":"Or","triggers":["manual"],"notes":"URL changes on restart"}
```

---

### 2.3 TODO-by-Actor

**Purpose:** Clear task tracking organized by who should do what.

**Location Options:**

| Option | Pros | Cons | Recommendation |
|--------|------|------|----------------|
| **A.** New section in `SYSTEM_SNAPSHOT.md` | Single file, easy to maintain | Makes SNAPSHOT.md longer | â­ **Recommended** |
| **B.** New file `docs/TODO_BY_ACTOR.md` | Clean separation | Another file to track | Good alternative |
| **C.** In `SYSTEM_SNAPSHOT_DRIVE.md` only | Simplest | Not in repo SSOT | Not recommended |

**Recommended: Option A** â€” Add section to existing `SYSTEM_SNAPSHOT.md`

**Proposed Format:**

```markdown
## ğŸ“‹ TODO by Actor

### Or (Human CEO)
| Task | Priority | Status | Notes |
|------|----------|--------|-------|
| Approve Phase 2 completion | High | Pending | After checklist done |
| Review SNAPSHOT_LAYER_DESIGN | Medium | In Progress | This doc |

### Claude Desktop
| Task | Priority | Status | Notes |
|------|----------|--------|-------|
| Create AUTOMATIONS_REGISTRY.jsonl | High | Pending | Block 3 |
| Update Drive Snapshot after changes | Medium | Ongoing | Semi-auto |

### GPT GitHub Operator
| Task | Priority | Status | Notes |
|------|----------|--------|-------|
| Sync Drive snapshot after repo PRs | Medium | Pending | After layer ready |

### GPT Planning Model
| Task | Priority | Status | Notes |
|------|----------|--------|-------|
| Review SNAPSHOT_LAYER_DESIGN | High | Pending | Via Or |
| Propose refinements to snapshot structure | Medium | Pending | After review |
```

---

## 3. Mapping: Existing â†’ Target

### 3.1 SYSTEM_SNAPSHOT.md â†’ SYSTEM_SNAPSHOT_DRIVE.md

| Existing Section | Action | Target Section |
|------------------|--------|----------------|
| System Overview | **Copy** (shortened) | System Overview |
| Architecture diagram | **Link** or simplify | Architecture |
| Active Services table | **Copy** | Active Services |
| GPT Integration section | **Merge** into Agents | Agents & Roles |
| Chat1 section | **Merge** into Agents | Agents & Roles |
| Known Limitations | **Move** to | Risks & Open Items |
| Next Steps (Planned) | **Reference** | Active Phase & Plans |
| Version History | **Keep in repo only** | â€” |

**Key Principle:** Drive snapshot is a **consolidated view**, not a copy. Link back to repo for details.

### 3.2 Other Docs Integration

| Document | Integration Approach |
|----------|---------------------|
| `CONTROL_PLANE_SPEC.md` | **Extract** Mode/Phase/Variables â†’ Metadata section |
| `AGENTS_INVENTORY.md` | **Summarize** â†’ Agents & Roles section |
| `PHASE2_CHECKLIST.md` | **Link** + status summary â†’ Active Phase section |
| `DECISIONS_AI_OS.md` | **Link only** â€” don't duplicate decisions |
| `EVENT_TIMELINE_SPEC.md` | **Use format** for Recent Events section |
| `CONSTITUTION.md` | **Link only** â€” governance reference |

### 3.3 What Stays Repo-Only

| Content | Why Repo-Only |
|---------|---------------|
| Full architecture diagram | Too detailed for Drive view |
| Version history | Repo concern, not snapshot |
| Detailed endpoint specs | Reference docs, not state |
| Security policies | Sensitive, governance docs |
| Workflow definitions | Operational docs |

---

## 4. Minimal Changes Plan (Repo First)

### Phase 1: Add Missing Files (Block 3 scope)

| # | Change | File | Risk | Notes |
|---|--------|------|------|-------|
| 1 | Create | `docs/AUTOMATIONS_REGISTRY.jsonl` | ğŸŸ¢ Low | New file, no impact |
| 2 | Add section | `docs/SYSTEM_SNAPSHOT.md` â†’ TODO by Actor | ğŸŸ¢ Low | Additive only |
| 3 | Add section | `docs/SYSTEM_SNAPSHOT.md` â†’ Metadata | ğŸŸ¢ Low | Additive only |
| 4 | Create | `docs/templates/SNAPSHOT_DRIVE_TEMPLATE.md` | ğŸŸ¢ Low | Template for Drive doc |

### Phase 2: Initialize Event Timeline (Optional, Block 4)

| # | Change | File | Risk | Notes |
|---|--------|------|------|-------|
| 5 | Create | `logs/EVENT_TIMELINE.jsonl` | ğŸŸ¢ Low | New file |
| 6 | Add first entries | Same | ğŸŸ¢ Low | Document this work |

### What We're NOT Changing

- âŒ Not restructuring existing docs
- âŒ Not moving files around
- âŒ Not renaming anything
- âŒ Not deleting anything
- âŒ Not changing CONTROL_PLANE_SPEC structure
- âŒ Not modifying CONSTITUTION

---

## 5. Drive Snapshot Generation Plan

### 5.1 Generation Method

**Approach:** Semi-automated, human-triggered

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Snapshot Generation Flow                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚   [Trigger]                                                 â”‚
â”‚      â”‚                                                      â”‚
â”‚      â–¼                                                      â”‚
â”‚   Or says: "Update Drive Snapshot" (to Claude or GPT)       â”‚
â”‚      â”‚                                                      â”‚
â”‚      â–¼                                                      â”‚
â”‚   [Read Repo State]                                         â”‚
â”‚      â”‚                                                      â”‚
â”‚      â”œâ”€â”€ SYSTEM_SNAPSHOT.md                                 â”‚
â”‚      â”œâ”€â”€ CONTROL_PLANE_SPEC.md                              â”‚
â”‚      â”œâ”€â”€ AGENTS_INVENTORY.md                                â”‚
â”‚      â”œâ”€â”€ AUTOMATIONS_REGISTRY.jsonl                         â”‚
â”‚      â”œâ”€â”€ PHASE2_CHECKLIST.md                                â”‚
â”‚      â””â”€â”€ EVENT_TIMELINE.jsonl (if exists)                   â”‚
â”‚      â”‚                                                      â”‚
â”‚      â–¼                                                      â”‚
â”‚   [Generate Snapshot]                                       â”‚
â”‚      â”‚                                                      â”‚
â”‚      â”œâ”€â”€ Use SNAPSHOT_DRIVE_TEMPLATE.md as base             â”‚
â”‚      â”œâ”€â”€ Fill in current values                             â”‚
â”‚      â”œâ”€â”€ Add timestamp + generator info                     â”‚
â”‚      â””â”€â”€ Calculate confidence based on freshness            â”‚
â”‚      â”‚                                                      â”‚
â”‚      â–¼                                                      â”‚
â”‚   [Write to Drive]                                          â”‚
â”‚      â”‚                                                      â”‚
â”‚      â””â”€â”€ Create/Update SYSTEM_SNAPSHOT_DRIVE.md in Drive    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Who Does What

| Actor | Role in Snapshot Generation |
|-------|----------------------------|
| **Or** | Triggers update ("please update snapshot") |
| **Claude Desktop** | Reads repo files, generates snapshot, writes to Drive |
| **GPT GitHub Operator** | Can also generate (if given repo access + Drive write) |
| **GPT Planning Model** | Consumer only â€” reads snapshot, doesn't generate |

### 5.3 Trigger Events

| Trigger | Priority | Notes |
|---------|----------|-------|
| End of significant session | High | After major work blocks |
| Phase transition | High | Moving from Phase 2 â†’ 3 |
| After meaningful repo PR merged | Medium | When state changes |
| Weekly refresh | Low | Prevent staleness |
| On request | Always | Or or agent asks for update |

### 5.4 Confidence Calculation

| Condition | Confidence Level |
|-----------|-----------------|
| All sources read within 1 hour | ğŸŸ¢ High |
| Sources read within 24 hours | ğŸŸ¡ Medium |
| Sources older than 24 hours | ğŸ”´ Low â€” recommend refresh |
| Missing critical source | âš ï¸ Partial â€” note gaps |

---

## 6. Open Questions / Risks

### 6.1 Open Questions

| # | Question | Options | My Suggestion |
|---|----------|---------|---------------|
| 1 | **Where in Drive should snapshot live?** | Root / Dedicated folder / Shared folder | Dedicated folder: "AI-OS System" |
| 2 | **Snapshot file name?** | `SYSTEM_SNAPSHOT_DRIVE.md` / `AI-OS_Snapshot.md` / other | Keep `SYSTEM_SNAPSHOT_DRIVE.md` for clarity |
| 3 | **How detailed should Agents section be?** | Full table / Summary only / Links | Summary + link to AGENTS_INVENTORY.md |
| 4 | **Include code snippets in snapshot?** | Yes / No | No â€” keep it readable, link to repo |
| 5 | **Version the Drive snapshot?** | Single file (overwrite) / Versioned files | Single file + mention last version in metadata |
| 6 | **Hebrew or English?** | Hebrew / English / Mixed | English for structure, Hebrew allowed in notes |

### 6.2 Risks

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| **Snapshot drifts from repo** | Medium | Medium | Clear triggers, freshness metadata, periodic refresh |
| **Duplication creates confusion** | Medium | High | Drive is clearly marked as "view", links back to repo SSOT |
| **Too much manual work** | Medium | Medium | Keep it simple, semi-auto process |
| **GPT can't write to Drive** | Low | Low | Claude handles Drive writes, GPT reads only |
| **Registry becomes stale** | Medium | Medium | Include "last_verified" field, periodic review |

### 6.3 Design Decisions Needed from Or / GPT Planning

1. **Approve file locations:**
   - `docs/AUTOMATIONS_REGISTRY.jsonl` âœ“?
   - `docs/templates/SNAPSHOT_DRIVE_TEMPLATE.md` âœ“?
   - TODO section in `SYSTEM_SNAPSHOT.md` âœ“?

2. **Approve Drive location:**
   - Create "AI-OS System" folder in Drive?
   - Or use root?

3. **Approve generation flow:**
   - Claude generates, Or triggers?
   - Any role for GPT GitHub Operator?

4. **Scope of Block 3:**
   - Just Registry + TODO section?
   - Or also template + first Drive snapshot?

---

## 7. Proposed Block 3 Scope

Based on the "minimal changes" principle, I suggest Block 3 includes:

### Must Have (Block 3)
1. âœ… Create `docs/AUTOMATIONS_REGISTRY.jsonl` with initial records
2. âœ… Add "TODO by Actor" section to `docs/SYSTEM_SNAPSHOT.md`
3. âœ… Add "Metadata" section to `docs/SYSTEM_SNAPSHOT.md`

### Nice to Have (Block 3 or 4)
4. ğŸŸ¡ Create `docs/templates/SNAPSHOT_DRIVE_TEMPLATE.md`
5. ğŸŸ¡ Create first `SYSTEM_SNAPSHOT_DRIVE.md` in Drive

### Later (Block 4+)
6. â³ Create `logs/EVENT_TIMELINE.jsonl`
7. â³ Establish regular sync rhythm

---

## Summary

| Component | Location | Status | Block |
|-----------|----------|--------|-------|
| SYSTEM_SNAPSHOT.md (enhanced) | Repo | Existing + additions | 3 |
| AUTOMATIONS_REGISTRY.jsonl | Repo | To create | 3 |
| TODO-by-Actor | In SYSTEM_SNAPSHOT.md | To add | 3 |
| SNAPSHOT_DRIVE_TEMPLATE.md | Repo | To create | 3-4 |
| SYSTEM_SNAPSHOT_DRIVE.md | Drive | To create | 3-4 |
| EVENT_TIMELINE.jsonl | Repo | To create | 4+ |

---

## 8. Block 3 Implementation Log

**Date:** 2025-11-25  
**Executed By:** Claude Desktop  
**Status:** âœ… Complete

### Changes Made

| # | Action | File | Notes |
|---|--------|------|-------|
| 1 | Created directory | `docs/system_state/` | New folder for state-related files |
| 2 | Created file | `docs/system_state/AUTOMATIONS_REGISTRY.jsonl` | 8 initial automation records |
| 3 | Added section | `docs/SYSTEM_SNAPSHOT.md` â†’ Metadata | Snapshot ID, phase, mode, etc. |
| 4 | Added section | `docs/SYSTEM_SNAPSHOT.md` â†’ TODO-by-Actor | 4 actors with tasks |
| 5 | Updated | `docs/SYSTEM_SNAPSHOT.md` â†’ Version History | v2.1 entry |
| 6 | Created file | `docs/system_state/SYSTEM_SNAPSHOT_DRIVE_TEMPLATE.md` | Full template with all sections |

### Files Created

1. **`docs/system_state/AUTOMATIONS_REGISTRY.jsonl`**
   - 8 automation records (AUTO-001 through AUTO-008)
   - Covers: GPT Manager, GitHub Client, Google Client, Chat1, ngrok, Agent Gateway, GPT Planner, Action Executor
   - Schema matches design spec

2. **`docs/system_state/SYSTEM_SNAPSHOT_DRIVE_TEMPLATE.md`**
   - Full template with all proposed sections
   - Includes usage instructions at bottom
   - Ready for Block 4 Drive generation

### Files Modified

1. **`docs/SYSTEM_SNAPSHOT.md`**
   - Added Metadata section (top of file)
   - Added TODO-by-Actor section (before Version History)
   - Updated Version History to v2.1
   - Updated Last Updated footer

### Decisions Made During Implementation

| Decision | Choice | Rationale |
|----------|--------|----------|
| Registry location | `docs/system_state/` | Groups all state files together, cleaner than `docs/` root |
| Initial records count | 8 automations | Covered all currently documented automations |
| TODO section placement | Before Version History | Keeps it visible but doesn't break existing flow |

### What's Ready for Block 4

- âœ… AUTOMATIONS_REGISTRY exists with real data
- âœ… SYSTEM_SNAPSHOT.md has Metadata + TODO sections
- âœ… Template ready for Drive snapshot generation
- â³ Need: Create Drive folder "AI-OS System State"
- â³ Need: Generate first actual SYSTEM_SNAPSHOT_DRIVE.md

---

## 9. Block 4 Implementation Log â€” First Drive Snapshot

**Date:** 2025-11-25  
**Executed By:** Claude Desktop  
**Status:** âœ… Complete

### Drive Resources Created

| Resource | Type | ID | Link |
|----------|------|-----|------|
| AI-OS System State | Folder (attempted) | 1H3i5IEqAii7VPELcpiyNBWqsd1Nm6tMt | [Drive](https://drive.google.com/file/d/1H3i5IEqAii7VPELcpiyNBWqsd1Nm6tMt/view) |
| SYSTEM_SNAPSHOT_DRIVE | Google Doc | 1-ysIo2isMJpHjlYXsUgIBdkL4y21QPb- | [View](https://docs.google.com/document/d/1-ysIo2isMJpHjlYXsUgIBdkL4y21QPb-) |

### Technical Notes

1. **Folder Creation Issue:**
   - Attempted to create folder "AI-OS System State" via google-mcp
   - API created it as `application/octet-stream` instead of actual folder
   - Workaround: Created Google Doc directly at Drive root
   - **Future:** May need manual folder organization or different API approach

2. **Document Format:**
   - Created as Google Doc (`application/vnd.google-apps.document`)
   - Not pure markdown file due to API constraints
   - Content is markdown-formatted text inside the doc
   - GPT Planning Model can read it natively

### Data Sources Used

| Source File | Sections Populated |
|-------------|--------------------|
| `docs/SYSTEM_SNAPSHOT.md` | Overview, Architecture, Services, TODO |
| `docs/CONTROL_PLANE_SPEC.md` | Phase, Mode, Variables |
| `docs/PHASE2_CHECKLIST.md` | Phase progress items |
| `agents/AGENTS_INVENTORY.md` | Agents & Roles table |
| `docs/system_state/AUTOMATIONS_REGISTRY.jsonl` | Automations summary |
| `docs/system_state/SYSTEM_SNAPSHOT_DRIVE_TEMPLATE.md` | Document structure |

### Snapshot Content Sections

1. âœ… **Metadata** â€” Snapshot ID, generation time, phase, mode, confidence
2. âœ… **System Overview** â€” What is AI-OS, core principles
3. âœ… **Architecture** â€” Simplified diagram + data flow
4. âœ… **Active Services** â€” 3 services with capabilities
5. âœ… **Agents & Roles** â€” 7 agents with status
6. âœ… **Active Phase & Plans** â€” Phase 2 checklist progress
7. âœ… **Automations Summary** â€” 8 automations from registry
8. âœ… **TODO by Actor** â€” 4 actors with tasks
9. âœ… **Risks & Tech Debt** â€” 4 risks, 3 tech debt items
10. âœ… **Recent Key Events** â€” Block 1-4 timeline
11. âœ… **Links to Repo** â€” 8 key documents
12. âœ… **Notes** â€” Usage instructions for GPT Planning Model

### Update Policy Established

| Policy | Decision |
|--------|----------|
| Versioning | **Overwrite** â€” Single file, not versioned |
| Trigger | Manual (Or or agent request) |
| Frequency | After significant changes, end of session, phase transition |
| Generator | Claude Desktop (primary), GPT GitHub (secondary) |
| Freshness | Metadata includes generation time + confidence level |

### Future Sync Flow (Proposed)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Manual Sync Flow                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚   [Or requests update]                                    â”‚
â”‚          â”‚                                                 â”‚
â”‚          â–¼                                                 â”‚
â”‚   [Claude reads repo files]                               â”‚
â”‚          â”‚                                                 â”‚
â”‚          â”œâ”€â”€ SYSTEM_SNAPSHOT.md                           â”‚
â”‚          â”œâ”€â”€ CONTROL_PLANE_SPEC.md                        â”‚
â”‚          â”œâ”€â”€ AUTOMATIONS_REGISTRY.jsonl                   â”‚
â”‚          â”œâ”€â”€ PHASE2_CHECKLIST.md                          â”‚
â”‚          â””â”€â”€ AGENTS_INVENTORY.md                          â”‚
â”‚          â”‚                                                 â”‚
â”‚          â–¼                                                 â”‚
â”‚   [Claude updates Google Doc]                             â”‚
â”‚          â”‚                                                 â”‚
â”‚          â–¼                                                 â”‚
â”‚   [GPT Planning Model reads updated snapshot]             â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Open Items for Future

| Item | Priority | Notes |
|------|----------|-------|
| Organize Drive folder structure | Low | Manual folder creation may be needed |
| Automate sync via script | Low | Only after manual process is stable |
| Add EVENT_TIMELINE.jsonl integration | Medium | When timeline exists |
| Consider markdown file instead of Google Doc | Low | Depends on GPT access patterns |

---

**End of Design Document**

**Snapshot Layer Status:** âœ… Operational (Manual Mode) + Wired to Control Plane

**Completed:**
- Block 1-4: Core implementation
- Block 5: Control Plane & Init Wiring

---

## 10. Block 5 Implementation Log â€” Control Plane & Init Wiring

**Date:** 2025-11-25  
**Executed By:** Claude Desktop  
**Status:** âœ… Complete

### Purpose

Make the Snapshot Layer an **official part** of the AI-OS Control Plane, so every agent knows about it during onboarding.

### Files Updated

| File | Change | Purpose |
|------|--------|--------|
| `docs/CONTROL_PLANE_SPEC.md` | Added `## Drive Snapshot Layer` section | Define what, where, who, when |
| `docs/SESSION_INIT_CHECKLIST.md` | Added `## Drive Snapshot Awareness` section | Agent onboarding knows about snapshot |
| `docs/SYSTEM_SNAPSHOT.md` | Added `## Drive Snapshot` bridge section | Link repo snapshot to Drive version |
| `docs/system_state/AUTOMATIONS_REGISTRY.jsonl` | Added `AUTO-009` entry | Register Drive Snapshot Sync process |

### New Sections Added

#### CONTROL_PLANE_SPEC.md (v0.3)

**Section:** `## Drive Snapshot Layer`

- What is `SYSTEM_SNAPSHOT_DRIVE`
- Where it lives (Google Doc, link)
- Who updates it (Claude Desktop primary, GPT GitHub secondary)
- When to refresh (before planning, after changes, weekly)
- Data sources list
- Related documentation links

#### SESSION_INIT_CHECKLIST.md (v0.2)

**Section:** `## Drive Snapshot Awareness (All Agents)`

- Two snapshot types explained (Repo vs Drive)
- Agent type guidelines table:
  - Planning agents â†’ Use Drive as Primary View
  - Executor agents â†’ Generator, don't auto-update
  - UI/Chat agents â†’ Consumer
- Instructions for each agent type
- Snapshot location and link

#### SYSTEM_SNAPSHOT.md (v2.3)

**Section:** `## Drive Snapshot`

- Bridge between repo and Drive versions
- Clear statement: repo is SSOT, Drive is derivative
- Link to Drive doc
- Reference to design documentation

#### AUTOMATIONS_REGISTRY.jsonl

**New Entry:** `AUTO-009`

```json
{
  "id": "AUTO-009",
  "name": "Drive Snapshot Sync",
  "type": "state_sync",
  "platform": "Google Drive",
  "status": "manual_trigger",
  "owner": "Claude Desktop",
  "human_in_loop": true,
  "triggers": [
    "manual_request_from_or",
    "before_major_planning",
    "after_significant_changes"
  ],
  "target_doc": "SYSTEM_SNAPSHOT_DRIVE",
  "sources": [5 repo files listed]
}
```

### Integration Points

The Snapshot Layer is now referenced in:

1. **Control Plane** â†’ Official system component
2. **Session Init** â†’ Agent onboarding awareness
3. **System Snapshot** â†’ Bridge to Drive version
4. **Automations Registry** â†’ Registered process

### Agent Awareness Matrix

| Agent | Should Know About Drive Snapshot? | Role |
|-------|----------------------------------|------|
| GPT Planning Model | âœ… Yes | Primary consumer |
| Claude Desktop | âœ… Yes | Primary generator |
| GPT GitHub Operator | âœ… Yes | Secondary generator |
| Chat1 | âœ… Yes | Can reference if needed |
| Any new agent | âœ… Yes | Via SESSION_INIT_CHECKLIST |

---

## Summary: Snapshot Layer Project Complete

| Block | What | Status |
|-------|------|--------|
| Block 1 | Mapping & Understanding | âœ… Done |
| Block 2 | Design & Plan | âœ… Done |
| Block 3 | Repo Infra (Registry, TODO, Template) | âœ… Done |
| Block 4 | First Drive Snapshot | âœ… Done |
| Block 5 | Control Plane & Init Wiring | âœ… Done |

**The Snapshot Layer is now fully operational and officially integrated into AI-OS.**
